name: ILCDexchanges
id: https://example.org/ILCDexchanges
license: CC-BY-4.0

imports:
  - linkml:types
  - linkml_shared_definitions # Reuse classes from SharedDefinitions

prefixes:
  linkml: https://w3id.org/linkml/
  ILCDex: https://example.org/ILCDexchanges/
default_prefix: ILCDex

########################################
# Classes
########################################
classes:
  Exchanges:
    attributes:
      id:
        identifier: true
    description: "Top-level container for the 'exchanges' section."
    slots:
      - exchange

  # Each item in 'exchange' array
  ExchangeEntry:
    attributes:
      id:
        identifier: true
    description: "A single exchange entry with flow data, amounts, and properties."
    slots:
      - dataSetInternalID
      - referenceToFlowDataSet
      - meanAmount
      - referenceFlow
      - resultingflowAmount
      - flowProperties
      - resolvedFlowVersion
      - materialProperties
      - typeOfFlow
      - exchangeDirection # rename from 'exchange direction'
      - otherEx # second exchange has 'other' with anies
      - classificationEx # for 'classification' { classHierarchy, name }

  # Define a local sub-class to override the shared 'OtherContent'
  # so that we can override 'anies' to reference a specialized Anies
  ExchangeOtherContent:
    attributes:
      id:
        identifier: true
    is_a: OtherContent
    description: "Local sub-class that enforces 'module' is required."
    slot_usage:
      anies:
        range: AniesNameValueObjectValueModule

  # For arrays in 'flowProperties'
  FlowPropertyEntry:
    attributes:
      id:
        identifier: true
    description: "One flow property with name, uuid, referenceFlowProperty, meanValue, referenceUnit, unitGroupUUID."
    slots:
      - nameFP
      - uuidFP
      - referenceFlowProperty
      - meanValue
      - referenceUnit
      - unitGroupUUID

  # 'other': e.g. has 'anies', reusing existing 'OtherContent', but we name it 'otherEx'
  # We'll just map it in the ExchangeEntry slot.

  # classification e.g. {classHierarchy: 'Quantities', name: 'GaBiCategories'}
  ExchangeClassification:
    attributes:
      id:
        identifier: true
    description: "Simple object for classification with 'classHierarchy' and 'name'."
    slots:
      - classHierarchy
      - nameClass

  # -- Material Properties
  MaterialPropEntry:
    attributes:
      id:
        identifier: true
    description: "Material property list with name, value, unit, unitDescription."
    slots:
      - name
      - value
      - unit
      - unitDescription

########################################
# Slots
########################################
slots:
  # --- Exchanges
  exchange:
    range: ExchangeEntry
    multivalued: true
    inlined_as_list: true
    description: "List of ExchangeEntry objects."

  # --- ExchangeEntry
  dataSetInternalID:
    range: integer
    description: "Integer ID for the dataset within the exchange."

  referenceToFlowDataSet:
    range: ShortDescripTypeRefVersion
    inlined: true
    description: "Reference to flow dataset with shortDescription, type, refObjectId, version."

  meanAmount:
    range: float
    description: "Mean quantity for the exchange."

  referenceFlow:
    range: boolean
    description: "If true, indicates this is a reference flow."

  resultingflowAmount:
    range: float
    description: "Resulting flow amount."

  flowProperties:
    range: FlowPropertyEntry
    multivalued: true
    inlined_as_list: true
    description: "Array of flow properties."

  materialProperties:
    range: MaterialPropEntry
    multivalued: true
    inlined_as_list: true
    description: "Array of material properties."

  resolvedFlowVersion:
    range: string
    description: "Version of the resolved flow."

  typeOfFlow:
    range: string
    description: "String identifying the type of flow (e.g., 'Product flow', 'Other flow')."

  exchangeDirection:
    range: string
    description: "Renamed from 'exchange direction'; indicates flow direction (INPUT/OUTPUT)."

  otherEx:
    range: ExchangeOtherContent
    inlined: true
    description: "Equivalent to 'other' in JSON, storing anies with modules or references."

  classificationEx:
    range: ExchangeClassification
    inlined: true
    description: "Flow classification object with classHierarchy and name."

  # --- FlowPropertyEntry
  uuidFP:
    range: UUIDType
    description: "UUID for the flow property."

  referenceFlowProperty:
    range: boolean
    description: "Indicates if this property is the reference flow property."

  meanValue:
    range: float
    description: "Mean numeric value of the flow property."

  referenceUnit:
    range: string
    description: "Units (e.g., 'm3')."

  unitGroupUUID:
    range: UUIDType
    description: "UUID referencing the unit group."

  # --- ExchangeClassification
  classHierarchy:
    range: string
    description: "Classification hierarchy string (e.g., 'Quantities')."

  nameClass:
    range: string
    description: "Classification system name (e.g., 'GaBiCategories')."

  nameFP:
    range: MultiLangString
    multivalued: true
    inlined_as_list: true
    description: "Name of the flow property"
